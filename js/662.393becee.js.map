{"version":3,"file":"js/662.393becee.js","mappings":"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","sources":["webpack://mumu/./src/views/webrtc.vue","webpack://mumu/./src/components/PeerConnection.vue","webpack://mumu/src/components/PeerConnection.vue","webpack://mumu/./src/components/PeerConnection.vue?e779","webpack://mumu/./src/components/PeerConnection.vue?b201","webpack://mumu/src/views/webrtc.vue","webpack://mumu/./src/views/webrtc.vue?9848","webpack://mumu/./src/views/webrtc.vue?3506"],"sourcesContent":["var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',[_c('PeerConnection')],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',{staticClass:\"webrtc-app\"},[_c('header',{staticClass:\"header-bar\"},[_c('button',{staticClass:\"back-btn\",on:{\"click\":_vm.goBack}},[_c('svg',{attrs:{\"viewBox\":\"0 0 24 24\"}},[_c('path',{attrs:{\"d\":\"M15.41,16.58L10.83,12L15.41,7.41L14,6L8,12L14,18L15.41,16.58Z\"}})])]),_c('h1',{staticClass:\"header-title\"},[_vm._v(_vm._s(_vm.pageTitle))]),_c('div',{staticClass:\"header-placeholder\"})]),_c('main',{staticClass:\"app-main\"},[_c('div',{staticClass:\"connection-status\"},[_c('div',{staticClass:\"status-indicator\",class:_vm.connectionStatusClass},[_vm._v(\" \"+_vm._s(_vm.connectionStatusText)+\" \")]),_c('div',{staticClass:\"peer-id-display\"},[_c('span',[_vm._v(\"你的ID: \"),_c('strong',[_vm._v(_vm._s(_vm.peerId))])]),_c('button',{staticClass:\"copy-btn\",on:{\"click\":_vm.copyPeerId}},[_c('svg',{staticClass:\"copy-icon\",attrs:{\"viewBox\":\"0 0 24 24\"}},[_c('path',{attrs:{\"d\":\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"}})]),_vm._v(\" 复制 \")])])]),_c('div',{staticClass:\"connection-controls\"},[_c('div',{staticClass:\"connect-input\"},[_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.remotePeerId),expression:\"remotePeerId\"}],attrs:{\"placeholder\":\"输入对方ID\",\"disabled\":_vm.isConnected},domProps:{\"value\":(_vm.remotePeerId)},on:{\"input\":function($event){if($event.target.composing)return;_vm.remotePeerId=$event.target.value}}}),_c('button',{staticClass:\"connect-btn\",attrs:{\"disabled\":!_vm.remotePeerId || _vm.isConnected},on:{\"click\":_vm.connectToPeer}},[_vm._v(\" 连接 \")])]),_c('button',{staticClass:\"disconnect-btn\",attrs:{\"disabled\":!_vm.isConnected},on:{\"click\":_vm.disconnect}},[_vm._v(\" 断开连接 \")])]),_c('div',{staticClass:\"message-area\"},[_c('div',{ref:\"messageContainer\",staticClass:\"message-container\"},_vm._l((_vm.messages),function(message,index){return _c('div',{key:index,class:['message', message.type],style:({ marginBottom: index < _vm.messages.length - 1 ? '1rem' : '0' })},[_c('div',{staticClass:\"message-content\"},[_c('span',{staticClass:\"message-sender\"},[_vm._v(_vm._s(message.sender))]),_c('span',{staticClass:\"message-text\"},[_vm._v(_vm._s(message.text))]),_c('span',{staticClass:\"message-time\"},[_vm._v(_vm._s(message.time))])])])}),0)]),_c('div',{staticClass:\"message-input-area\"},[_c('button',{staticClass:\"send-btn\",attrs:{\"disabled\":!_vm.isConnected || !_vm.newMessage},on:{\"click\":_vm.sendMessage}},[_vm._v(\" 发送 \")])])]),_vm._m(0),_c('transition',{attrs:{\"name\":\"fade\"}},[(_vm.showToast)?_c('div',{staticClass:\"toast\",class:_vm.toastType},[_c('svg',{staticClass:\"toast-icon\",attrs:{\"viewBox\":\"0 0 24 24\"}},[(_vm.toastType === 'success')?_c('path',{attrs:{\"d\":\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"}}):_vm._e(),(_vm.toastType === 'error')?_c('path',{attrs:{\"d\":\"M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z\"}}):_vm._e()]),_c('span',{staticClass:\"toast-message\"},[_vm._v(_vm._s(_vm.toastMessage))])]):_vm._e()])],1)\n}\nvar staticRenderFns = [function (){var _vm=this,_c=_vm._self._c;return _c('footer',{staticClass:\"app-footer\"},[_c('div',{staticClass:\"footer-note\"},[_c('p',[_vm._v(\"© 沐沐同步工具\")])])])\n}]\n\nexport { render, staticRenderFns }","<template>\r\n  <div class=\"webrtc-app\">\r\n    <!-- 顶部标题栏 - 带返回按钮 -->\r\n    <header class=\"header-bar\">\r\n      <button class=\"back-btn\" @click=\"goBack\">\r\n        <svg viewBox=\"0 0 24 24\">\r\n          <path d=\"M15.41,16.58L10.83,12L15.41,7.41L14,6L8,12L14,18L15.41,16.58Z\" />\r\n        </svg>\r\n      </button>\r\n      <h1 class=\"header-title\">{{ pageTitle }}</h1>\r\n      <div class=\"header-placeholder\"></div>\r\n    </header>\r\n\r\n    <!-- 主内容区 -->\r\n    <main class=\"app-main\">\r\n      <!-- 连接状态区域 -->\r\n      <div class=\"connection-status\">\r\n        <div class=\"status-indicator\" :class=\"connectionStatusClass\">\r\n          {{ connectionStatusText }}\r\n        </div>\r\n        <div class=\"peer-id-display\">\r\n          <span>你的ID: <strong>{{ peerId }}</strong></span>\r\n          <button @click=\"copyPeerId\" class=\"copy-btn\">\r\n            <svg class=\"copy-icon\" viewBox=\"0 0 24 24\">\r\n              <path\r\n                d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\" />\r\n            </svg>\r\n            复制\r\n          </button>\r\n        </div>\r\n      </div>\r\n\r\n      <!-- 连接控制区域 -->\r\n      <div class=\"connection-controls\">\r\n        <div class=\"connect-input\">\r\n          <input v-model=\"remotePeerId\" placeholder=\"输入对方ID\" :disabled=\"isConnected\">\r\n          <button @click=\"connectToPeer\" :disabled=\"!remotePeerId || isConnected\" class=\"connect-btn\">\r\n            连接\r\n          </button>\r\n        </div>\r\n        <button @click=\"disconnect\" :disabled=\"!isConnected\" class=\"disconnect-btn\">\r\n          断开连接\r\n        </button>\r\n      </div>\r\n\r\n      <!-- 消息区域 -->\r\n      <div class=\"message-area\">\r\n        <div class=\"message-container\" ref=\"messageContainer\">\r\n          <div v-for=\"(message, index) in messages\" :key=\"index\" :class=\"['message', message.type]\"\r\n            :style=\"{ marginBottom: index < messages.length - 1 ? '1rem' : '0' }\">\r\n            <div class=\"message-content\">\r\n              <span class=\"message-sender\">{{ message.sender }}</span>\r\n              <span class=\"message-text\">{{ message.text }}</span>\r\n              <span class=\"message-time\">{{ message.time }}</span>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      <!-- 消息输入区域 -->\r\n      <div class=\"message-input-area\">\r\n        <button @click=\"sendMessage\" :disabled=\"!isConnected || !newMessage\" class=\"send-btn\">\r\n          发送\r\n        </button>\r\n      </div>\r\n    </main>\r\n\r\n    <!-- 应用页脚 -->\r\n    <footer class=\"app-footer\">\r\n      <div class=\"footer-note\">\r\n        <p>© 沐沐同步工具</p>\r\n      </div>\r\n    </footer>\r\n\r\n    <!-- 通知提示 -->\r\n    <transition name=\"fade\">\r\n      <div v-if=\"showToast\" class=\"toast\" :class=\"toastType\">\r\n        <svg class=\"toast-icon\" viewBox=\"0 0 24 24\">\r\n          <path v-if=\"toastType === 'success'\" d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\" />\r\n          <path v-if=\"toastType === 'error'\"\r\n            d=\"M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z\" />\r\n        </svg>\r\n        <span class=\"toast-message\">{{ toastMessage }}</span>\r\n      </div>\r\n    </transition>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\n  import Peer from 'peerjs';\r\n\r\n  export default {\r\n    name: 'WebRTCApp',\r\n    data() {\r\n      return {\r\n        peer: null,\r\n        peerId: '',\r\n        remotePeerId: '',\r\n        connection: null,\r\n        messages: [],\r\n        newMessage: '',\r\n        connectionStatus: 'disconnected', // disconnected, connecting, connected\r\n        showToast: false,\r\n        toastMessage: '',\r\n        toastType: 'success',\r\n        pageTitle: '' // 新增：动态页面标题\r\n      };\r\n    },\r\n    created() {\r\n      this.pageTitle = this.$route.query.name\r\n    },\r\n    computed: {\r\n      isConnected() {\r\n        return this.connectionStatus === 'connected';\r\n      },\r\n      connectionStatusText() {\r\n        const statusMap = {\r\n          disconnected: '未连接',\r\n          connecting: '连接中...',\r\n          connected: '已连接'\r\n        };\r\n        return statusMap[this.connectionStatus];\r\n      },\r\n      connectionStatusClass() {\r\n        return this.connectionStatus;\r\n      }\r\n    },\r\n    mounted() {\r\n      this.initializePeer();\r\n    },\r\n    methods: {\r\n      goBack() {\r\n        this.$goBackOrHome()\r\n      },\r\n      initializePeer() {\r\n        // 创建Peer实例\r\n        this.peer = new Peer({\r\n          host: '0.peerjs.com',\r\n          port: 443,\r\n          secure: true,\r\n          debug: 3\r\n        });\r\n\r\n        this.peer.on('open', (id) => {\r\n          this.peerId = id;\r\n          this.showNotification('已准备好连接', 'success');\r\n        });\r\n\r\n        this.peer.on('connection', (conn) => {\r\n          this.handleIncomingConnection(conn);\r\n        });\r\n\r\n        this.peer.on('error', (err) => {\r\n          console.error('Peer error:', err);\r\n          this.showNotification(`连接错误`, 'error');\r\n          this.connectionStatus = 'disconnected';\r\n        });\r\n      },\r\n\r\n      connectToPeer() {\r\n        if (!this.remotePeerId) return;\r\n\r\n        this.connectionStatus = 'connecting';\r\n        this.addSystemMessage(`正在连接 ${this.remotePeerId}...`);\r\n\r\n        const conn = this.peer.connect(this.remotePeerId);\r\n        this.handleOutgoingConnection(conn);\r\n      },\r\n\r\n      handleIncomingConnection(conn) {\r\n        this.connection = conn;\r\n        this.setupConnectionHandlers();\r\n        this.connectionStatus = 'connected';\r\n        this.addSystemMessage(`${conn.peer} 已连接`);\r\n      },\r\n\r\n      handleOutgoingConnection(conn) {\r\n        this.connection = conn;\r\n        this.setupConnectionHandlers();\r\n\r\n        conn.on('open', () => {\r\n          this.connectionStatus = 'connected';\r\n          this.addSystemMessage(`已连接到 ${conn.peer}`);\r\n        });\r\n      },\r\n\r\n      setupConnectionHandlers() {\r\n        this.connection.on('data', (data) => {\r\n          this.addMessage('对方', data, 'remote');\r\n        });\r\n\r\n        this.connection.on('close', () => {\r\n          this.addSystemMessage('连接已关闭');\r\n          this.connectionStatus = 'disconnected';\r\n          this.connection = null;\r\n        });\r\n\r\n        this.connection.on('error', (err) => {\r\n          console.error('Connection error:', err);\r\n          this.addSystemMessage(`连接错误: ${err.message}`);\r\n          this.connectionStatus = 'disconnected';\r\n        });\r\n      },\r\n\r\n      disconnect() {\r\n        if (this.connection) {\r\n          this.connection.close();\r\n        }\r\n        this.connectionStatus = 'disconnected';\r\n        this.connection = null;\r\n      },\r\n\r\n      sendMessage() {\r\n        if (!this.newMessage.trim() || !this.connection) return;\r\n\r\n        try {\r\n          this.connection.send(this.newMessage);\r\n          this.addMessage('我', this.newMessage, 'local');\r\n          this.newMessage = '';\r\n        } catch (err) {\r\n          this.showNotification(`发送失败`, 'error');\r\n        }\r\n      },\r\n\r\n      addMessage(sender, text, type) {\r\n        this.messages.push({\r\n          sender,\r\n          text,\r\n          type,\r\n          time: new Date().toLocaleTimeString()\r\n        });\r\n        this.scrollToBottom();\r\n      },\r\n\r\n      addSystemMessage(text) {\r\n        this.addMessage('系统', text, 'system');\r\n      },\r\n\r\n      scrollToBottom() {\r\n        this.$nextTick(() => {\r\n          const container = this.$el.querySelector('.message-container');\r\n          container.scrollTop = container.scrollHeight;\r\n        });\r\n      },\r\n\r\n      copyPeerId() {\r\n        if (this.copyToClipboard(this.peerId)) {\r\n          this.showNotification('ID已复制到剪贴板', 'success')\r\n        } else {\r\n          this.showNotification('复制失败', 'error')\r\n        }\r\n      },\r\n      copyToClipboard(text) {\r\n        if (navigator.clipboard) {\r\n          return navigator.clipboard.writeText(text)\r\n            .then(() => true)\r\n            .catch(() => false);\r\n        } else {\r\n          return new Promise((resolve) => {\r\n            const textarea = document.createElement('textarea');\r\n            textarea.value = text;\r\n            textarea.style.position = 'fixed';\r\n            document.body.appendChild(textarea);\r\n            textarea.select();\r\n            \r\n            try {\r\n              const successful = document.execCommand('copy');\r\n              resolve(successful);\r\n            } catch (err) {\r\n              resolve(false);\r\n            }\r\n            \r\n            document.body.removeChild(textarea);\r\n          });\r\n        }\r\n      },\r\n\r\n      showNotification(message, type = 'success') {\r\n        this.toastMessage = message;\r\n        this.toastType = type;\r\n        this.showToast = true;\r\n\r\n        setTimeout(() => {\r\n          this.showToast = false;\r\n        }, 3000);\r\n      }\r\n    },\r\n    beforeDestroy() {\r\n      if (this.connection) {\r\n        this.connection.close();\r\n      }\r\n      if (this.peer) {\r\n        this.peer.destroy();\r\n      }\r\n    }\r\n  };\r\n</script>\r\n\r\n<style scoped>\r\n  .webrtc-app {\r\n    max-width: 100%;\r\n    min-height: 100vh;\r\n    display: flex;\r\n    flex-direction: column;\r\n    background-color: #f8fafc;\r\n    font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;\r\n    line-height: 1.5;\r\n    color: #334155;\r\n  }\r\n\r\n  /* 顶部标题栏样式 */\r\n  .header-bar {\r\n    position: sticky;\r\n    top: 0;\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: space-between;\r\n    padding: 12px 16px;\r\n    background-color: #fff;\r\n    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);\r\n    z-index: 100;\r\n  }\r\n\r\n  .back-btn {\r\n    background: none;\r\n    border: none;\r\n    padding: 8px;\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: center;\r\n    cursor: pointer;\r\n  }\r\n\r\n  .back-btn svg {\r\n    width: 24px;\r\n    height: 24px;\r\n    fill: #333;\r\n  }\r\n\r\n  .header-title {\r\n    font-size: 18px;\r\n    font-weight: 500;\r\n    margin: 0;\r\n    text-align: center;\r\n    flex: 1;\r\n  }\r\n\r\n  .header-placeholder {\r\n    width: 40px;\r\n  }\r\n\r\n  .app-main {\r\n    flex: 1;\r\n    padding: 1rem 1.5rem;\r\n    max-width: 800px;\r\n    margin: 0 auto;\r\n    width: 100%;\r\n    box-sizing: border-box;\r\n  }\r\n\r\n  /* 连接状态区域 */\r\n  .connection-status {\r\n    display: flex;\r\n    justify-content: space-between;\r\n    align-items: center;\r\n    margin-bottom: 1.5rem;\r\n    padding: 1rem;\r\n    background-color: #ffffff;\r\n    border-radius: 0.75rem;\r\n    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);\r\n  }\r\n\r\n  .status-indicator {\r\n    padding: 0.5rem 1rem;\r\n    border-radius: 2rem;\r\n    font-size: 0.875rem;\r\n    font-weight: 500;\r\n    flex-shrink: 0;\r\n  }\r\n\r\n  .status-indicator.disconnected {\r\n    background-color: #fee2e2;\r\n    color: #dc2626;\r\n  }\r\n\r\n  .status-indicator.connecting {\r\n    background-color: #fef3c7;\r\n    color: #d97706;\r\n  }\r\n\r\n  .status-indicator.connected {\r\n    background-color: #dcfce7;\r\n    color: #16a34a;\r\n  }\r\n\r\n  .peer-id-display {\r\n    display: flex;\r\n    align-items: center;\r\n    gap: 0.5rem;\r\n  }\r\n\r\n  .copy-btn {\r\n    display: flex;\r\n    align-items: center;\r\n    gap: 0.25rem;\r\n    padding: 0.375rem 0.75rem;\r\n    background-color: #f1f5f9;\r\n    border: none;\r\n    border-radius: 0.375rem;\r\n    font-size: 0.75rem;\r\n    color: #64748b;\r\n    cursor: pointer;\r\n    transition: all 0.2s;\r\n    flex-shrink: 0;\r\n  }\r\n\r\n  .copy-btn:hover {\r\n    background-color: #e2e8f0;\r\n  }\r\n\r\n  .copy-icon {\r\n    width: 1rem;\r\n    height: 1rem;\r\n    fill: currentColor;\r\n  }\r\n\r\n  /* 连接控制区域 */\r\n  .connection-controls {\r\n    display: flex;\r\n    flex-direction: column;\r\n    gap: 1rem;\r\n  }\r\n\r\n  .connect-input {\r\n    display: flex;\r\n  }\r\n\r\n  .connect-input input {\r\n    flex: 1;\r\n    padding: 0.75rem 1rem;\r\n    border: 1px solid #e2e8f0;\r\n    border-radius: 0.5rem;\r\n    font-size: 0.875rem;\r\n    transition: border-color 0.2s;\r\n  }\r\n\r\n  .connect-input input:focus {\r\n    outline: none;\r\n    border-color: #93c5fd;\r\n  }\r\n\r\n  .connect-btn,\r\n  .disconnect-btn {\r\n    padding: 0.75rem 1.5rem;\r\n    border: none;\r\n    border-radius: 0.5rem;\r\n    font-size: 0.875rem;\r\n    font-weight: 500;\r\n    cursor: pointer;\r\n    transition: all 0.2s;\r\n  }\r\n\r\n  .connect-btn {\r\n    margin-left: 0.5rem;\r\n    background-color: #3b82f6;\r\n    color: white;\r\n  }\r\n\r\n  .connect-btn:hover:not(:disabled) {\r\n    background-color: #2563eb;\r\n  }\r\n\r\n  .connect-btn:disabled {\r\n    background-color: #bfdbfe;\r\n    cursor: not-allowed;\r\n  }\r\n\r\n  .disconnect-btn {\r\n    background-color: #f8fafc;\r\n    border: 1px solid #e2e8f0;\r\n    color: #64748b;\r\n    margin-bottom: 1.5rem;\r\n  }\r\n\r\n  .disconnect-btn:hover:not(:disabled) {\r\n    background-color: #f1f5f9;\r\n    border-color: #cbd5e1;\r\n  }\r\n\r\n  .disconnect-btn:disabled {\r\n    cursor: not-allowed;\r\n    opacity: 0.7;\r\n  }\r\n\r\n  /* 消息区域 */\r\n  .message-area {\r\n    flex: 1;\r\n    margin-bottom: 1rem;\r\n    background-color: #ffffff;\r\n    border-radius: 0.75rem;\r\n    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);\r\n    overflow: hidden;\r\n    padding: 0.5rem;\r\n  }\r\n\r\n  .message-container {\r\n    height: 400px;\r\n    padding: 0.5rem;\r\n    overflow-y: auto;\r\n    scroll-behavior: smooth;\r\n  }\r\n\r\n  .message {\r\n    margin-bottom: 1rem;\r\n    max-width: 80%;\r\n    display: flex;\r\n    flex-direction: column;\r\n  }\r\n\r\n  .message-content {\r\n    display: flex;\r\n    justify-content: space-between;\r\n    align-items: flex-start;\r\n    padding: 0.75rem 1rem;\r\n    border-radius: 1rem;\r\n    position: relative;\r\n    word-break: break-word;\r\n  }\r\n\r\n  .message.local {\r\n    margin-left: auto;\r\n    text-align: right;\r\n  }\r\n\r\n  .message.local .message-content {\r\n    background-color: #3b82f6;\r\n    color: white;\r\n    border-bottom-right-radius: 0.25rem;\r\n  }\r\n\r\n  .message.remote {\r\n    margin-right: auto;\r\n    text-align: left;\r\n  }\r\n\r\n  .message.remote .message-content {\r\n    background-color: #f1f5f9;\r\n    color: #334155;\r\n    border-bottom-left-radius: 0.25rem;\r\n  }\r\n\r\n  .message.system {\r\n    margin-left: auto;\r\n    margin-right: auto;\r\n    text-align: center;\r\n  }\r\n\r\n  .message.system .message-content {\r\n    background-color: transparent;\r\n    color: #64748b;\r\n    font-size: 0.75rem;\r\n    padding: 0.25rem 0;\r\n    border: none;\r\n  }\r\n\r\n  .message-sender {\r\n    font-size: 0.75rem;\r\n    font-weight: 600;\r\n    margin-bottom: 0.25rem;\r\n    color: inherit;\r\n  }\r\n\r\n  .message-text {\r\n    flex: 1;\r\n  }\r\n\r\n  .message-time {\r\n    font-size: 0.625rem;\r\n    color: #94a3b8;\r\n    margin-left: auto;\r\n    opacity: 0.8;\r\n  }\r\n\r\n  .message.local .message-time {\r\n    margin-left: 0;\r\n    margin-right: 0.5rem;\r\n  }\r\n\r\n  /* 消息输入区域 */\r\n  .message-input-area {\r\n    display: flex;\r\n    gap: 0.5rem;\r\n    margin-bottom: 1.5rem;\r\n  }\r\n\r\n  .message-input-area input {\r\n    flex: 1;\r\n    padding: 0.75rem 1rem;\r\n    border: 1px solid #e2e8f0;\r\n    border-radius: 0.5rem;\r\n    font-size: 0.875rem;\r\n    transition: border-color 0.2s;\r\n  }\r\n\r\n  .message-input-area input:focus {\r\n    outline: none;\r\n    border-color: #93c5fd;\r\n  }\r\n\r\n  .send-btn {\r\n    width: 100%;\r\n    height: 46px;\r\n    padding: 0 1.5rem;\r\n    background-color: #3b82f6;\r\n    color: white;\r\n    border: none;\r\n    border-radius: 0.5rem;\r\n    font-size: 0.875rem;\r\n    font-weight: 500;\r\n    cursor: pointer;\r\n    transition: background-color 0.2s;\r\n  }\r\n\r\n  .send-btn:hover:not(:disabled) {\r\n    background-color: #2563eb;\r\n  }\r\n\r\n  .send-btn:disabled {\r\n    background-color: #bfdbfe;\r\n    cursor: not-allowed;\r\n  }\r\n\r\n  /* 应用页脚 */\r\n  .app-footer {\r\n    background-color: #ffffff;\r\n    padding: 1.5rem;\r\n    border-top: 1px solid #e2e8f0;\r\n    text-align: center;\r\n  }\r\n\r\n  .footer-note {\r\n    font-size: 0.75rem;\r\n    color: #94a3b8;\r\n  }\r\n\r\n  /* 通知提示 */\r\n  .toast {\r\n    position: fixed;\r\n    bottom: 1.5rem;\r\n    left: 50%;\r\n    transform: translateX(-50%);\r\n    display: flex;\r\n    align-items: center;\r\n    gap: 0.5rem;\r\n    padding: 0.75rem 1.25rem;\r\n    border-radius: 0.5rem;\r\n    box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);\r\n    z-index: 50;\r\n    font-size: 0.875rem;\r\n    font-weight: 500;\r\n  }\r\n\r\n  .toast.success {\r\n    background-color: #ecfdf5;\r\n    color: #065f46;\r\n  }\r\n\r\n  .toast.error {\r\n    background-color: #fef2f2;\r\n    color: #b91c1c;\r\n  }\r\n\r\n  .toast-icon {\r\n    width: 1.25rem;\r\n    height: 1.25rem;\r\n    flex-shrink: 0;\r\n  }\r\n\r\n  .toast-message {\r\n    white-space: nowrap;\r\n  }\r\n\r\n  /* 过渡动画 */\r\n  .fade-enter-active,\r\n  .fade-leave-active {\r\n    transition: opacity 0.2s ease;\r\n  }\r\n\r\n  .fade-enter,\r\n  .fade-leave-to {\r\n    opacity: 0;\r\n  }\r\n\r\n  /* 响应式设计 */\r\n  @media (max-width: 640px) {\r\n    .message-container {\r\n      height: 300px;\r\n    }\r\n\r\n    .message {\r\n      max-width: 90%;\r\n    }\r\n\r\n    .message-text {\r\n      font-size: 0.875rem;\r\n    }\r\n\r\n    .message-time {\r\n      font-size: 0.6rem;\r\n    }\r\n\r\n    .header-title {\r\n      font-size: 16px;\r\n    }\r\n  }\r\n</style>","import mod from \"-!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./PeerConnection.vue?vue&type=script&lang=js\"; export default mod; export * from \"-!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./PeerConnection.vue?vue&type=script&lang=js\"","import { render, staticRenderFns } from \"./PeerConnection.vue?vue&type=template&id=1c6d408c&scoped=true\"\nimport script from \"./PeerConnection.vue?vue&type=script&lang=js\"\nexport * from \"./PeerConnection.vue?vue&type=script&lang=js\"\nimport style0 from \"./PeerConnection.vue?vue&type=style&index=0&id=1c6d408c&prod&scoped=true&lang=css\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"1c6d408c\",\n  null\n  \n)\n\nexport default component.exports","<template>\n  <div>\n    <PeerConnection />\n  </div>\n</template>\n\n<script>\nimport PeerConnection from '@/components/PeerConnection.vue'\n\nexport default {\n  name: 'App',\n  components: {\n    PeerConnection\n  }\n}\n</script>\n\n<style>\n</style>","import mod from \"-!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./webrtc.vue?vue&type=script&lang=js\"; export default mod; export * from \"-!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./webrtc.vue?vue&type=script&lang=js\"","import { render, staticRenderFns } from \"./webrtc.vue?vue&type=template&id=654c8e38\"\nimport script from \"./webrtc.vue?vue&type=script&lang=js\"\nexport * from \"./webrtc.vue?vue&type=script&lang=js\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports"],"names":["render","_vm","this","_c","_self","staticRenderFns","staticClass","on","goBack","attrs","_v","_s","pageTitle","class","connectionStatusClass","connectionStatusText","peerId","copyPeerId","directives","name","rawName","value","remotePeerId","expression","isConnected","domProps","$event","target","composing","connectToPeer","disconnect","ref","_l","messages","message","index","key","type","style","marginBottom","length","sender","text","time","newMessage","sendMessage","_m","showToast","toastType","_e","toastMessage","data","peer","connection","connectionStatus","created","$route","query","computed","statusMap","disconnected","connecting","connected","mounted","initializePeer","methods","$goBackOrHome","Peer","host","port","secure","debug","id","showNotification","conn","handleIncomingConnection","err","console","error","addSystemMessage","connect","handleOutgoingConnection","setupConnectionHandlers","addMessage","close","trim","send","push","Date","toLocaleTimeString","scrollToBottom","$nextTick","container","$el","querySelector","scrollTop","scrollHeight","copyToClipboard","navigator","clipboard","writeText","then","catch","Promise","resolve","textarea","document","createElement","position","body","appendChild","select","successful","execCommand","removeChild","setTimeout","beforeDestroy","destroy","component","components","PeerConnection"],"sourceRoot":""}